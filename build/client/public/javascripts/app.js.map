{"version":3,"sources":["app/application.coffee","app/collections/album.coffee","app/collections/photo.coffee","app/initialize.coffee","app/lib/base_view.coffee","app/lib/client.coffee","app/lib/clipboard.coffee","app/lib/helpers.coffee","app/lib/map_providers.coffee","app/lib/modal.coffee","app/lib/socket_listener.coffee","app/lib/view_collection.coffee","app/locales/de.json","app/locales/en.json","app/locales/es.json","app/locales/fr.json","app/models/album.coffee","app/models/photo.coffee","app/models/photoprocessor.coffee","app/models/thumbprocessor.coffee","app/router.coffee","app/templates/album.jade","app/templates/albumlist.jade","app/templates/albumlist_item.jade","app/templates/browser.jade","app/templates/galery.jade","app/templates/map.jade","app/templates/photo.jade","app/views/album.coffee","app/views/albumslist.coffee","app/views/albumslist_item.coffee","app/views/browser.coffee","app/views/galery.coffee","app/views/map.coffee","app/views/photo.coffee"],"names":[],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnGA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxGA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnGA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArGA;AAAA;;ACAA;EAAA;iSAAA;;AAAA,kBAAkB,QAAQ,mBAAR,CAAlB;;AAAA,MACA,GAAS,QAAQ,eAAR,CADT;;AAAA,MAQM,CAAC,OAAP,GAAuB;AAEnB;;AAAA,4BAAS,QAAT;;AAAA,kBAEA,WAAU;WACN;AAAA,aAAO,EAAP;AAAA,MACA,aAAa,EADb;AAAA,MAEA,WAAW,EAFX;AAAA,MAGA,UAAU,kBAHV;AAAA,MAIA,aAAa,CAJb;AAAA,MAKA,SAAS,IALT;MADM;EAAA,CAFV;;AAAA,kBAUA,MAAK;WAAG,6CAAQ,GAAG,CAAC,OAAf;EAAA,CAVL;;AAYa;AACT,QAAC,OAAD,GAAc,qBAAd;AACA,WAAO,kDAAP,CAFS;EAAA,CAZb;;AAAA,kBAiBA,QAAO,SAAC,KAAD;AAEH;AAAA,6CAAe,CAAE,gBAAd,GAAuB,CAA1B;AACI,UAAC,OAAM,CAAC,KAAR,CAAc,KAAK,CAAC,MAApB,EAA4B;AAAA,eAAO,IAAP;OAA5B,EADJ;KAAA;AAAA,IAEA,YAAY,CAAC,MAFb;AAKA,QAAG,KAAK,CAAC,YAAN,IAAuB,KAAK,CAAC,YAAN,KAAwB,MAAlD;AACI,WAAK,CAAC,KAAN,GAAc,KAAK,CAAC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CA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnHA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;;ACAA;EAAA;;oFAAA;;AAAA,MAAM,QAAQ,aAAR,CAAN;;AAAA,QAEA,GAAW,QAAQ,eAAR,CAFX;;AAAA,MAGA,GAAS,QAAQ,cAAR,CAHT;;AAAA,SAIA,GAAY,QAAQ,eAAR,CAJZ;;AA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","file":"public/javascripts/app.js","sourcesContent":["SocketListener = require './lib/socket_listener'\n\nmodule.exports =\n\n    initialize: ->\n\n        window.app = this\n        # Translation helpers.\n        @locale = window.locale\n        @polyglot = new Polyglot locale: @locale\n        try\n            locales = require 'locales/'+ @locale\n        catch e\n            locales = require 'locales/en'\n\n        @polyglot.extend locales\n        window.t = @polyglot.t.bind @polyglot\n\n        AlbumCollection = require('collections/album')\n        Router = require('router')\n\n        @router = new Router()\n\n        $(window).on \"hashchange\", @router.hashChange\n        $(window).on \"beforeunload\", @router.beforeUnload\n\n        # Base data\n        @albums = new AlbumCollection()\n\n        @urlKey = \"\"\n        if window.location.search\n            for param in window.location.search.substring(1).split '&'\n                [key, value] = param.split '='\n                @urlKey = \"?key=#{value}\" if key is 'key'\n\n        @mode = if window.location.pathname.match /public/ then 'public'\n        else 'owner'\n\n        if @mode isnt 'public'\n            # on public pages, realtime is not available, so we don't need\n            # the socket listener, to prevent 404\n            @socketListener = new SocketListener()\n\n        # Display albums. Fetch data if no data were loaded via server index.\n        if window.initalbums\n            @albums.reset window.initalbums, parse: true\n            delete window.initalbums\n            Backbone.history.start()\n        else\n            @albums.fetch().done -> Backbone.history.start()\n","# AlbumCollection\n# is a collection of Albums (models/album)\n# define the endpoint where Backbone will fetch the list of album\n\nmodule.exports = class AlbumCollection extends Backbone.Collection\n\n    model: require 'models/album'\n    url: 'albums' + app.urlKey\n    comparator: (model) -> model.get 'title'\n","# PhotoCollection\n# is a collection of Photos (models/photo)\n# define the endpoint where Backbone will fetch the list of photos\n\nmodule.exports = class PhotoCollection extends Backbone.Collection\n\n    model: require 'models/photo'\n    url: -> 'photos' + app.urlKey\n    comparator: (model) -> model.get 'date'\n\n    hasGPS: ()->\n        return new PhotoCollection this.filter (photo)->\n            return photo.get(\"gps\").lat?\n\n    hasNotGPS: ()->\n        return new PhotoCollection this.filter (photo)->\n            return !photo.get(\"gps\").lat?\n","app = require 'application'\n\n$ ->\n    jQuery.event.props.push 'dataTransfer'\n    app.initialize()\n\n    # Initialize Spin JS the lib that displays loading indicators\n    $.fn.spin = (opts, color) ->\n        presets =\n            tiny:\n                lines: 8\n                length: 2\n                width: 2\n                radius: 3\n\n            small:\n                lines: 8\n                length: 1\n                width: 2\n                radius: 5\n\n            large:\n                lines: 10\n                length: 8\n                width: 4\n                radius: 8\n\n        if Spinner\n            @each ->\n                $this = $(this)\n                spinner = $this.data(\"spinner\")\n                if spinner?\n                    spinner.stop()\n                    $this.data \"spinner\", null\n                else if opts isnt false\n                    if typeof opts is \"string\"\n                        if opts of presets\n                            opts = presets[opts]\n                        else\n                            opts = {}\n                        opts.color = color    if color\n                    spinner = new Spinner(\n                        $.extend(color: $this.css(\"color\"), opts))\n                    spinner.spin(this)\n                    $this.data \"spinner\", spinner\n\n        else\n            console.log \"Spinner class not available.\"\n            null\n","# BaseView used to DRY other views\n# - copy view options in view object\n# - pass the options, as well as getRenderData to the template\n# - render the template inside its el\n# provide a afterRender hook\n\nmodule.exports = class BaseView extends Backbone.View\n    initialize: (options) ->\n        @options = options\n\n    template: ->\n\n    getRenderData: ->\n\n    render: =>\n        data = _.extend {}, @options, @getRenderData()\n        @$el.html @template(data)\n        @afterRender()\n        this\n\n    afterRender: ->\n","\n# Make ajax request more easy to do.\n# Expected callbacks: success and error\nexports.request = (type, url, data, callbacks) ->\n\n    success = callbacks.success or (res) -> callbacks null, res\n    error = callbacks.error or (err) -> callbacks err\n\n\n    $.ajax\n        type: type\n        url: url\n        data: data\n        success: success\n        error: error\n\n# Sends a get request with data as body\n# Expected callbacks: success and error\nexports.get = (url, callbacks) ->\n    exports.request \"GET\", url, null, callbacks\n\n# Sends a post request with data as body\n# Expected callbacks: success and error\nexports.post = (url, data, callbacks) ->\n    exports.request \"POST\", url, data, callbacks\n\n# Sends a put request with data as body\n# Expected callbacks: success and error\nexports.put = (url, data, callbacks) ->\n    exports.request \"PUT\", url, data, callbacks\n\n# Sends a delete request with data as body\n# Expected callbacks: success and error\nexports.del = (url, callbacks) ->\n    exports.request \"DELETE\", url, null, callbacks\n","# Facilitator to allow user to copy url to clipboard in a easy way.\nmodule.exports = class Clipboard\n\n    constructor: ->\n        @value = \"\"\n\n        $(document).keydown (e) =>\n            # Check if value exist and if user wants to copy\n            if not @value or not(e.ctrlKey or e.metaKey)\n                return\n            if window.getSelection?()?.toString()\n                return\n\n            if document.selection?.createRange().text\n                return\n            _.defer =>\n                $clipboardContainer = $(\"#clipboard-container\")\n                $clipboardContainer.empty().show()\n                $(\"<textarea id='clipboard'></textarea>\")\n                .val(@value)\n                .appendTo($clipboardContainer)\n                .focus()\n                .select()\n\n        $(document).keyup (e) ->\n            if $(e.target).is(\"#clipboard\")\n                $(\"<textarea id='clipboard'></textarea>\").val(\"\")\n                $(\"#clipboard-container\").empty().hide()\n\n    set: (value) =>\n        @value = value\n","module.exports =\n\n    # Simple shortener to display of a long text\n    # used for album descriptions on AlbumList page\n    # @TODO: make this HTML resistant\n    limitLength: (string, length) ->\n        if string? and string.length > length\n        then string.substring(0, length) + '...'\n        else string\n\n    # Focus a given element (required for content editable elements).\n    forceFocus: (el) ->\n        range = document.createRange()\n        range.selectNodeContents el[0]\n        sel = document.getSelection()\n        sel.removeAllRanges()\n        sel.addRange(range)\n        el.focus()\n\n    ## Helpers to rotate photos\n    # TODO refactor it with switch\n\n    rotate: (orientation, image) ->\n        if navigator.userAgent.search(\"Firefox\") isnt -1\n            transform = \"transform\"\n        else\n            transform = \"-webkit-transform\"\n        if orientation is undefined or orientation is 1\n            image.css transform, \"rotate(\" + 0 + \"deg)\"\n            return\n        else if orientation is 2\n            image.css transform, \"scale(-1, 1)\"\n        else if orientation is 3\n            image.css transform, \"rotate(\" + 180 + \"deg)\"\n        else if orientation is 4\n            image.css transform, \"scale(1, -1)\"\n        else if orientation is 5\n            image.css transform, \"rotate(\" + -90 + \"deg) scale(-1, 1) \"\n        else if orientation is 6\n            image.css transform, \"rotate(\" + 90 + \"deg)\"\n        else if orientation is 7\n            image.css transform, \"rotate(\" + 90 + \"deg) scale(-1, 1)\"\n        else if orientation is 8\n            image.css transform, \"rotate(\" + -90 + \"deg)\"\n\n    getRotate: (orientation, image) ->\n        if navigator.userAgent.search(\"Firefox\") isnt -1\n            transform = \"transform\"\n        else\n            transform = \"-webkit-transform\"\n        if orientation is undefined or orientation is 1\n            return transform + \": rotate(\" + 0 + \"deg)\"\n        else if orientation is 2\n            return transform + \": scale(-1, 1)\"\n        else if orientation is 3\n            return transform + \": rotate(\" + 180 + \"deg)\"\n        else if orientation is 4\n            return transform + \": scale(1, -1)\"\n        else if orientation is 5\n            return transform + \": rotate(\" + -90 + \"deg) scale(-1, 1) \"\n        else if orientation is 6\n            return transform + \": rotate(\" + 90 + \"deg)\"\n        else if orientation is 7\n            return transform + \": rotate(\" + 90 + \"deg) scale(-1, 1)\"\n        else if orientation is 8\n            return transform + \": rotate(\" + -90 + \"deg)\"\n\n    rotateLeft: (orientation, image) ->\n        if orientation is undefined or orientation is 1\n            return 8\n        else if orientation is 2\n            return 5\n        else if orientation is 3\n            return 6\n        else if orientation is 4\n            return 7\n        else if orientation is 5\n            return 4\n        else if orientation is 6\n            return 1\n        else if orientation is 7\n            return 2\n        else if orientation is 8\n            return 3\n\n    rotateRight: (orientation, image) ->\n        if orientation is undefined or orientation is 1\n            return 6\n        else if orientation is 2\n            return 7\n        else if orientation is 3\n            return 8\n        else if orientation is 4\n            return 5\n        else if orientation is 5\n            return 2\n        else if orientation is 6\n            return 3\n        else if orientation is 7\n            return 4\n        else if orientation is 8\n            return 1\n","###\n    This file permit to add lots of map background, you can copy-paste\n    code from 'http://leaflet-extras.github.io/leaflet-providers/preview/'\n    and add a nex entry in this array, the default background is the first\n    indice.\n###\nmodule.exports =\n\n    'Water color': L.tileLayer 'http://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png',\n        attribution: 'Map by <a href=\"http://stamen.com\">Stamen Design</a>'\n        subdomains: 'abcd'\n        ext: 'png'\n        maxZoom: 12\n\n    'Open street map hot': L.tileLayer 'http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',\n        attribution: 'Map by <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n\n    'Esri world imagery': L.tileLayer 'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n        attribution: 'Map by Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP'\n\n    'Acetate all': L.tileLayer 'http://a{s}.acetate.geoiq.com/tiles/acetate-hillshading/{z}/{x}/{y}.png',\n\t   attribution: 'map by Esri & Stamen'\n\t   subdomains: '0123'\n","BaseView = require '../lib/base_view'\n\nmodule.exports = class ModalView extends BaseView\n\n    id: \"dialog-modal\"\n    className: \"modal fade\"\n    attributes:\n        'tab-index': -1\n    template: require './templates/modal'\n    value: 0\n\n    events: ->\n        \"click #modal-dialog-no\"  : \"onNo\"\n        \"click #modal-dialog-yes\" : \"onYes\"\n\n    constructor: (@title, @msg, @yes, @no, @cb, @hideOnYes) ->\n        super()\n        @hideOnYes = true unless @hideOnYes?\n\n    initialize: ->\n        @$el.on 'hidden.bs.modal', => @close()\n\n        @render()\n        @show()\n\n    onYes: ->\n        @cb true if @cb\n        @hide()\n\n    onNo: ->\n        @cb false if @cb\n        @hide() if @hideOnYes\n\n    onShow: ->\n\n    close: ->\n        setTimeout (() => @destroy()), 500\n\n    show: ->\n        @$el.modal 'show'\n        @$el.trigger 'show'\n\n    hide: ->\n        @$el.modal 'hide'\n        @$el.trigger 'hide'\n\n    render: ->\n        @$el.append @template(title: @title, msg: @msg, yes: @yes, no: @no)\n        $(\"body\").append @$el\n        @afterRender()\n        @\n\nmodule.exports.error = (code, cb) ->\n    new ModalView t(\"modal error\"), code, t(\"modal ok\"), false, cb\n","contactCollection = require 'cozy-clearance/contact_collection'\r\n\r\nmodule.exports = class ContactListener extends CozySocketListener\r\n\r\n    events: [\r\n        'contact.create'\r\n        'contact.update'\r\n        'contact.delete'\r\n    ]\r\n\r\n    process: (event) ->\r\n        if event.doctype is 'contact'\r\n            contactCollection.handleRealtimeContactEvent event","BaseView = require 'lib/base_view'\n\n# View that display a collection of subitems\n# used to DRY views\n# Usage : new ViewCollection(collection:collection)\n# Automatically populate itself by creating a itemView for each item\n# in its collection\n\n# can use a template that will be displayed alongside the itemViews\n\n# itemView       : the Backbone.View to be used for items\n# itemViewOptions : the options that will be passed to itemViews\n\nmodule.exports = class ViewCollection extends BaseView\n\n    views: {}\n\n    itemView: null\n\n\n    itemViewOptions: ->\n\n    # add 'empty' class to view when there is no subview\n    checkIfEmpty: ->\n        @$el.toggleClass 'empty', _.size(@views) is 0\n\n    # can be overriden if we want to place the subviews somewhere else\n    appendView: (view) ->\n\n        index = @collection.indexOf view.model\n\n        @$el.append view.$el\n        # if index is 0\n        # else\n\n        #     className = if view.className? then \".#{view.className}\"\n        #     else \"\"\n\n        #     tagName = view.tagName or \"\"\n\n        #     selector = \"#{tagName}#{className}:nth-of-type(#{index})\"\n        #     @$el.find(selector).after view.$el\n\n\n    # bind listeners to the collection\n    initialize: ->\n        super\n        @views = {}\n        @listenTo @collection, \"reset\",   @onReset\n        @listenTo @collection, \"add\",     @addItem\n        @listenTo @collection, \"sort\",    @render\n        @listenTo @collection, \"remove\",  @removeItem\n        @onReset @collection\n\n    # if we have views before a render call, we detach them\n    render: ->\n        view.$el.detach() for id, view of @views\n        super\n\n    # after render, we reattach the views\n    afterRender: ->\n        if @collection.length > 0\n            for i in [0..@collection.length-1]\n                @appendView @views[@collection.at(i).cid]\n\n            @checkIfEmpty @views\n\n    # destroy all sub views before remove\n    remove: ->\n        @onReset []\n        super\n\n    # event listener for reset\n    onReset: (newcollection) ->\n        view.remove() for id, view of @views\n        newcollection.forEach @addItem\n\n    # event listeners for add\n    addItem: (model) =>\n        options = _.extend {}, {model: model}, @itemViewOptions(model)\n        view = new @itemView(options)\n        @views[model.cid] = view.render()\n        @appendView view\n        @checkIfEmpty @views\n\n    # event listeners for remove\n    removeItem: (model) =>\n        @views[model.cid].remove()\n        delete @views[model.cid]\n        @checkIfEmpty @views\n\n","module.exports = {\n    \"or\": \"oder\",\n    \"Back\": \"Zurück\",\n    \"Create a new album\": \"Neues Album erstellen\",\n    \"Delete\": \"Löschen\",\n    \"Download\": \"Herunterladen\",\n    \"Edit\": \"Bearbeiten\",\n    \"Stop editing\": \"Änderungen speichern\",\n    \"It will appear on your homepage.\": \"Es wird auf dem Album Seite angezeigt.\",\n    \"Make it Hidden\": \"Verborgen\",\n    \"Make it Private\": \"Privat\",\n    \"Make it Public\": \"Öffentlich\",\n    \"New\": \"New\",\n    \"private\": \"Privat\",\n    \"public\": \"Öffentlich\",\n    \"hidden\": \"Verborgen\",\n    \"There is no photos in this album\": \"Es ist kein Foto in diesem Album. Klicken Sie Bearbeiten um neue hinzuzufügen.\",\n    \"There is no public albums.\": \"Es existiert kein Album.\",\n    \"This album is private\": \"Dieses Album ist privat\",\n    \"This album is hidden\": \"Dieses Album ist verborgen\",\n    \"This album is public\": \"Dieses Album is öffentlich\",\n    \"title placeholder\": \"Vergeben Sie einen Tittel für dieses Album…\",\n    \"View\": \"Ansicht\",\n    \"description placeholder\": \"Schreiben Sie eine Beschreibung…\",\n    \"is too big (max 10Mo)\": \"ist zu groß (max. 10Mo)\",\n    \"is not an image\": \"ist kein Bild\",\n    \"Share album by mail\": \"Album via E-Mail teilen\",\n    \"Upload your contacts...\": \"Ihre Kontakte hochladen…\",\n    \"Share album\": \"Album teilen\",\n    \"Add contact\": \"Kontact hinzufügen\",\n    \"Send mail\": \"E-Mail senden\",\n    \"Select your friends\": \"Ihre Freunde auswählen\",\n    \"Add\": \"Hinzufügen\",\n    \"Cancel\": \"Abbrechen\",\n    \"photo successfully set as cover\": \"Diese Bild ist erfolgreich als Album Cover vergeben\",\n    \"problem occured while setting cover\": \"Ein Problem ist aufgetreten während der Vergabe dieses Bild als Album Cover\",\n    \"pick from computer\": \"Klicken Sie hier oder ziehen Sie Ihre Bilder um Sie zu diesem Album hinzu zufügen.\",\n    \"pick from files\": \"Klicken Sie hier um Bilder von der Files app zu übernehmen.\",\n    \"hidden-description\": \"It will not appear on your homepage.\\nBut you can share it with the following url:\",\n    \"It cannot be accessed from the public side\": \"It is not a public resource.\",\n    \"rebuild thumbnails\": \"Neuaufbau Thumbnails\",\n    \"01\": \"Januar\",\n    \"02\": \"Februar\",\n    \"03\": \"März\",\n    \"04\": \"April\",\n    \"05\": \"Mai\",\n    \"06\": \"Juni\",\n    \"07\": \"Juli\",\n    \"08\": \"August\",\n    \"09\": \"September\",\n    \"10\": \"Oktober\",\n    \"11\": \"November\",\n    \"12\": \"Dezember\",\n    \"cancel\": \"Abbrechen\",\n    \"copy paste link\": \"Um Ihrem Kontakt Zugriff zu gewähren senden Sie Ihr/Ihm den Linnk unten:\",\n    \"details\": \"Details\",\n    \"inherited from\": \"geerbt von\",\n    \"modal question album shareable\": \"Wählen Sie Teilen Modus für diese Album\",\n    \"modal shared album custom msg\": \"E-Mail Adresse eingeben und Enter drücken\",\n    \"modal shared album link msg\": \"Senden Sie diesen Link um Leuten Zugriff zu diesem Album zu gewähren\",\n    \"modal shared public link msg\": \"Senden Sie diesen Link um Leuten Zugriff zu diesm Ordner zu gewähren:\",\n    \"modal shared with people msg\": \"Invite a selection of contacts to access it. Type\\nemail in the field and press enter (An email will be sent to them):\",\n    \"modal send mails\": \"Eine Mitteilung versenden\",\n    \"modal next\": \"Nächste\",\n    \"modal prev\": \"Vorherige\",\n    \"modal ok\": \"Ok\",\n    \"modal cancel\": \"Abbrechen\",\n    \"modal error\": \"Fehler\",\n    \"only you can see\": \"Nur Sie und die aufgelsiteten Leutehaben Zugriff auf diese Ressource\",\n    \"shared\": \"Geteilt\",\n    \"share\": \"Teilen\",\n    \"save\": \"Speichern\",\n    \"see link\": \"Siehe Link\",\n    \"send mails question\": \"Eine Mitteilungs E-Mail versenden an:\",\n    \"sharing\": \"Teilen\",\n    \"revoke\": \"Absagen\",\n    \"confirm\": \"Bestätigen\",\n    \"share forgot add\": \"Scheint so als ob Sie vergessen haben die Schaltfläche Hinzufügen zu drücken\",\n    \"share confirm save\": \"Die Änderungen die Sie an den Rechten vorgenommen haben, werden nicht gespeichert. Möchten Sie fortfahren?\",\n    \"yes forgot\": \"Zurück\",\n    \"no forgot\": \"es ist ok\",\n    \"perm\": \"can\",\n    \"perm r album\": \"Diese Album durchblättern\",\n    \"perm rw album\": \"Fotos durchblättern und hochladen\",\n    \"mail not send\": \"E-Mail nicht gesendet\",\n    \"server error occured\": \"Fehler auf Server Seite aufgetreten, bitte später noch einmal probieren\",\n    \"change notif\": \"Diesen Kasten anwählen um benachrichtigt zu werden, wenn eine Kontakt\\nein Bild zu diesem Album hinzufügt.\",\n    \"send email hint\": \"Mitteilungs E-Mails werden einmalig beim Speichern gesendet\",\n    \"yes\": \"Ja\",\n    \"no\": \"Nein\",\n    \"picture\": \"Bild |||| Bilder\",\n    \"delete empty album\": \"Dieses Album ist leer, möchten Sie es löschen?\",\n    \"are you sure you want to delete this album\": \"Sind Sie sicher diese Album zu löschen?\",\n    \"photos search\": \"Laden ...\",\n    \"no photos found\": \"Keine Bilder gefunden\",\n    \"thumb creation\": \"Applikation erstellt Thumbs für Dateien.\",\n    \"progress\": \"Fortschritt\",\n    \"Navigate before upload\": \"Hochladen noch aktiv, möchten Sie wirklich diese Seite verlassen?\",\n    \"application title\": \"Cozy - Fotos\"\n};","module.exports = {\n  \"or\": \"or\",\n  \"Back\": \"Back\",\n  \"Create a new album\": \"Create a new album\",\n  \"Delete\": \"Delete\",\n  \"Download\": \"Download\",\n  \"Edit\": \"Edit\",\n  \"Stop editing\": \"Save Changes\",\n  \"It will appear on your homepage.\": \"It will be displayed on the album page.\",\n  \"Make it Hidden\": \"hidden\",\n  \"Make it Private\": \"private\",\n  \"Make it Public\": \"public\",\n  \"New\": \"New\",\n  \"private\": \"private\",\n  \"public\": \"public\",\n  \"hidden\": \"hidden\",\n  \"There is no photos in this album\": \"There is no photo in this album. Click on Edit button to add new ones.\",\n  \"There is no public albums.\": \"There are no albums.\",\n  \"This album is private\": \"This album is private\",\n  \"This album is hidden\": \"This album is hidden\",\n  \"This album is public\": \"This album is public\",\n  \"title placeholder\": \"Set a title for this album…\",\n  \"View\": \"View\",\n  \"description placeholder\": \"Write a description…\",\n  \"is too big (max 10Mo)\": \"is too big (max 10Mo)\",\n  \"is not an image\": \"is not an image\",\n  \"Share album by mail\": \"Share album by mail\",\n  \"Upload your contacts...\": \"Upload your contacts…\",\n  \"Share album\": \"Share album\",\n  \"Add contact\": \"Add contact\",\n  \"Send mail\": \"Send mail\",\n  \"Select your friends\": \"Select your friends\",\n  \"Add\": \"Add\",\n  \"Cancel\": \"Cancel\",\n  \"photo successfully set as cover\": \"The picture has been successfully set as album cover\",\n  \"problem occured while setting cover\": \"A problem occured while setting picture as cover\",\n  \"pick from computer\": \"Click here or drag your photos below to add them to the album.\",\n  \"pick from files\": \"Click here to pick pictures from the Files app.\",\n  \"hidden-description\": \"It will not appear on your homepage.\\nBut you can share it with the following url:\",\n  \"It cannot be accessed from the public side\": \"It is not a public resource.\",\n  \"rebuild thumbnails\": \"Rebuild thumbnails\",\n  \"01\": \"January\",\n  \"02\": \"February\",\n  \"03\": \"March\",\n  \"04\": \"April\",\n  \"05\": \"May\",\n  \"06\": \"June\",\n  \"07\": \"July\",\n  \"08\": \"August\",\n  \"09\": \"September\",\n  \"10\": \"October\",\n  \"11\": \"November\",\n  \"12\": \"December\",\n  \"cancel\": \"Cancel\",\n  \"copy paste link\": \"To give access to your contact send him/her the link below:\",\n  \"details\": \"Details\",\n  \"inherited from\": \"inherited from\",\n  \"modal question album shareable\": \"Select share mode for this album\",\n  \"modal shared album custom msg\": \"Enter email and press enter\",\n  \"modal shared album link msg\": \"Send this link to let people access this album\",\n  \"modal shared public link msg\": \"Send this link to let people access this folder:\",\n  \"modal shared with people msg\": \"Invite a selection of contacts to access it. Type\\nemail in the field and press enter (An email will be sent to them):\",\n  \"modal send mails\": \"Send a notification\",\n  \"modal next\": \"Next\",\n  \"modal prev\": \"Previous\",\n  \"modal ok\": \"Ok\",\n  \"modal cancel\": \"Cancel\",\n  \"modal error\": \"Error\",\n  \"only you can see\": \"Only you and the people listed below can access this resource\",\n  \"public\": \"Public\",\n  \"private\": \"Private\",\n  \"shared\": \"Shared\",\n  \"share\": \"Share\",\n  \"save\": \"Save\",\n  \"see link\": \"See link\",\n  \"send mails question\": \"Send a notification email to:\",\n  \"sharing\": \"Sharing\",\n  \"revoke\": \"Revoke\",\n  \"confirm\": \"Confirm\",\n  \"share forgot add\": \"Looks like you forgot to click the Add button\",\n  \"share confirm save\": \"The changes you made to the permissions will not be saved. Do you want to continue?\",\n  \"yes forgot\": \"Back\",\n  \"no forgot\": \"It's ok\",\n  \"perm\": \"can \",\n  \"perm r album\": \"browse this album\",\n  \"perm rw album\": \"browse and upload photos\",\n  \"mail not send\": \"Mail not sent\",\n  \"server error occured\": \"Error occured on server side, please try again later\",\n  \"change notif\": \"Check this box to be notified when a contact\\nwill add a photo to this album.\",\n  \"send email hint\": \"Notification emails will be sent one time on save\",\n  \"yes\": \"Yes\",\n  \"no\": \"No\",\n  \"picture\": \"picture |||| pictures\",\n  \"delete empty album\": \"This album is empty, do you want to delete it?\",\n  \"are you sure you want to delete this album\": \"Are you sure you want to delete this album?\",\n  \"photos search\": \"Loading ...\",\n  \"no photos found\": \"No photos found\",\n  \"thumb creation\": \"Application creates thumbs for files.\",\n  \"progress\": \"Progression\",\n  \"Navigate before upload\": \"Some upload are in progress, do you really want to leave this page?\",\n  \"application title\": \"Cozy - photos\",\n  \"r\": \"read only\",\n  \"photo delete confirm\": \"Are you sure you want to delete this photo?\"\n}\n;","module.exports = {\n    \"or\": \"o\",\n    \"Back\": \"Atrás\",\n    \"Create a new album\": \"Crear un album\",\n    \"Delete\": \"Suprimir\",\n    \"Download\": \"Descargar\",\n    \"Edit\": \"Modificar\",\n    \"Stop editing\": \"Guardar los cambios\",\n    \"It will appear on your homepage.\": \"Aparecerá en su página de Inicio.\",\n    \"Make it Hidden\": \"oculto\",\n    \"Make it Private\": \"privado\",\n    \"Make it Public\": \"público\",\n    \"New\": \"Nuevo\",\n    \"private\": \"Privado\",\n    \"public\": \"Público\",\n    \"hidden\": \"oculto\",\n    \"There is no photos in this album\": \"No hay fotos en este album.\",\n    \"There is no public albums.\": \"No hay ningún album.\",\n    \"This album is private\": \"Este album es privado\",\n    \"This album is hidden\": \"Este album es oculto\",\n    \"This album is public\": \"Este album es público\",\n    \"title placeholder\": \"Título…\",\n    \"View\": \"Ver\",\n    \"description placeholder\": \"Descripción…\",\n    \"is too big (max 10Mo)\": \"es demasiado grande (max 10Mo)\",\n    \"is not an image\": \"no es una imagen\",\n    \"Share album by mail\": \"Compartir por correo electrónico\",\n    \"Upload your contacts...\": \"Cargar sus contactos…\",\n    \"Share album\": \"Compartir el album\",\n    \"Add contact\": \"Añadir un contacto\",\n    \"Send mail\": \"Enviar un mensaje\",\n    \"Select your friends\": \"Escoger a sus amigos\",\n    \"Add\": \"Añadir\",\n    \"Cancel\": \"Anular\",\n    \"photo successfully set as cover\": \"Se ha fijado exitosamente la imagen como  portada del album\",\n    \"problem occured while setting cover\": \"Ocurrió un problema al fijar la imagen como portada del album.\",\n    \"pick from computer\": \"Para añadir imágenes, haga clic aquí o arrastre y pegue sus fotos.\",\n    \"pick from files\": \"Hacer clic aquí para importar imágenes desde la aplicación Archivos.\",\n    \"hidden-description\": \"No aparecerá en su página Escritorio.\\nPero usted puede compartirlo en esta url:\",\n    \"It cannot be accessed from the public side\": \"No es un recurso público.\",\n    \"rebuild thumbnails\": \"Regenerar las miniaturas\",\n    \"01\": \"Enero\",\n    \"02\": \"Febrero\",\n    \"03\": \"Marzo\",\n    \"04\": \"Abril\",\n    \"05\": \"Mayo\",\n    \"06\": \"Junio\",\n    \"07\": \"Julio\",\n    \"08\": \"Agosto\",\n    \"09\": \"Septiembre\",\n    \"10\": \"Octubre\",\n    \"11\": \"Noviembre\",\n    \"12\": \"Diciembre\",\n    \"cancel\": \"Anular\",\n    \"copy paste link\": \"Para que su contacto pueda acceder, enviar este enlace:\",\n    \"details\": \"Detalles\",\n    \"inherited from\": \"heredado de\",\n    \"modal question album shareable\": \"Escoger la manera de compartir este album\",\n    \"modal shared album custom msg\": \"Insertar un correo electrónico y pulsar en Enter\",\n    \"modal shared album link msg\": \"Enviar este enlace para compartir este album\",\n    \"modal shared public link msg\": \"Enviar este enlace para compartir esta carpeta.\",\n    \"modal shared with people msg\": \"Invite a unos contactos seleccionados a acceder a él. Escriba\\nlos email en el campo y presione la tecla Enter (se les enviará un email):\",\n    \"modal send mails\": \"Enviar un aviso\",\n    \"modal next\": \"Siguiente\",\n    \"modal prev\": \"Precedente\",\n    \"modal ok\": \"Ok\",\n    \"modal cancel\": \"Anular\",\n    \"modal error\": \"Error\",\n    \"only you can see\": \"Sólo usted y las personas que aparecen en la lista siguiente pueden acceder al recurso\",\n    \"shared\": \"Compartido\",\n    \"share\": \"Compartir\",\n    \"save\": \"Guardar\",\n    \"see link\": \"Ver el enlace\",\n    \"send mails question\": \"Avisar por correo electrónico a:\",\n    \"sharing\": \"Compartiendo\",\n    \"revoke\": \"Revocar el permiso\",\n    \"confirm\": \"Confirmar\",\n    \"share forgot add\": \"Parece que a usted se le ha olvidado pulsar el botón Añadir\",\n    \"share confirm save\": \"Los cambios efectuados en los permisos no se tendrán en cuenta.¿Lo confirma?.\",\n    \"yes forgot\": \"Atrás\",\n    \"no forgot\": \"Ok\",\n    \"perm\": \"Usted puede\",\n    \"perm r album\": \"navegar en este album\",\n    \"perm rw album\": \"navegar en este album y cargar fotos\",\n    \"mail not send\": \"El mensaje no ha sido enviado\",\n    \"server error occured\": \"Ocurrió un error en el servidor, intentar de nuevo\",\n    \"change notif\": \"Marque esta casilla para recibir un aviso cozy cuando un contacto\\nañada una foto a este album.\",\n    \"send email hint\": \"Se avisa por correo electrónico cuando se guarda por primera vez\",\n    \"yes\": \"Si\",\n    \"no\": \"No\",\n    \"picture\": \"foto |||| fotos\",\n    \"delete empty album\": \"El album está vacío, ¿quiere suprimirlo?\",\n    \"are you sure you want to delete this album\": \"¿Esta seguro(a) que quiere borrar este album?\",\n    \"photos search\": \"Cargando ...\",\n    \"no photos found\": \"No se ha encontrado ninguna foto\",\n    \"thumb creation\": \"La aplicación está creando miniaturas para mejorar la navegación.\",\n    \"progress\": \"Avance\",\n    \"Navigate before upload\": \"Algunas páginas todavía no se han enviado al servidor, ¿desea realmente salir de esta página?\",\n    \"application title\": \"Cozy - fotos\"\n};","module.exports = {\n    \"or\": \"ou\",\n    \"Back\": \"Retour\",\n    \"Create a new album\": \"Créer un nouvel album\",\n    \"Delete\": \"Supprimer\",\n    \"Download\": \"Télécharger\",\n    \"Edit\": \"Modifier\",\n    \"Stop editing\": \"Enregistrer\",\n    \"It will appear on your homepage.\": \"Il sera affiché sur la page de l'album.\",\n    \"Make it Hidden\": \"masqué\",\n    \"Make it Private\": \"privé\",\n    \"Make it Public\": \"public\",\n    \"New\": \"Nouveau\",\n    \"private\": \"Privé\",\n    \"public\": \"Public\",\n    \"hidden\": \"masqué\",\n    \"There is no photos in this album\": \"Pas de photos dans cet album\",\n    \"There is no public albums.\": \"Il n'y a aucun album\",\n    \"This album is private\": \"Cet album est privé\",\n    \"This album is hidden\": \"Cet album est masqué\",\n    \"This album is public\": \"Cet album est public\",\n    \"title placeholder\": \"Titre...\",\n    \"View\": \"Voir\",\n    \"description placeholder\": \"Description...\",\n    \"is too big (max 10Mo)\": \"est trop grosse (max 10Mo)\",\n    \"is not an image\": \"n'est pas une image\",\n    \"Share album by mail\": \"Partagez par mail\",\n    \"Upload your contacts...\": \"Envoi de vos contacts\",\n    \"Share album\": \"Partagez l'album\",\n    \"Add contact\": \"Ajoutez un contact\",\n    \"Send mail\": \"Envoyez mail\",\n    \"Select your friends\": \"Choisissez vos amis\",\n    \"Add\": \"Ajouter\",\n    \"Cancel\": \"Annuler\",\n    \"photo successfully set as cover\": \"L'image est maintenant la couverture de l'album.\",\n    \"problem occured while setting cover\": \"Un problème est survenu en positionnant l'image comme couverture de\\nl'album.\",\n    \"pick from computer\": \"Cliquez ici ou glissez-déposez vos photos pour ajouter des images\",\n    \"pick from files\": \"Cliquez ici pour importer des images de l'application Files\",\n    \"hidden-description\": \"Il n'apparaîtra pas sur votre page d'accueil,\\nMais vous pouvez partager cette URL :\",\n    \"It cannot be accessed from the public side\": \"Ce n'est pas visible en public\",\n    \"rebuild thumbnails\": \"Regénérer les vignettes\",\n    \"01\": \"Janvier\",\n    \"02\": \"Février\",\n    \"03\": \"Mars\",\n    \"04\": \"Avril\",\n    \"05\": \"Mai\",\n    \"06\": \"Juin\",\n    \"07\": \"Juillet\",\n    \"08\": \"Août\",\n    \"09\": \"Septembre\",\n    \"10\": \"Octobre\",\n    \"11\": \"Novembre\",\n    \"12\": \"Décembre\",\n    \"cancel\": \"Annuler\",\n    \"copy paste link\": \"Pour donner accès à votre contact envoyez-lui ce lien :\",\n    \"details\": \"Détails\",\n    \"inherited from\": \"hérité de\",\n    \"modal question album shareable\": \"Choisissez le mode de partage pour cet album\",\n    \"modal shared album custom msg\": \"Entrez un email et appuyez sur Entrée\",\n    \"modal shared album link msg\": \"Envoyez ce lien pour permettre aux personnes d'accéder à l'album\",\n    \"modal shared public link msg\": \"Envoyez ce lien pour partager cet album\",\n    \"modal shared with people msg\": \"Invitez des personnes parmi vos contacts à y accéder. Saisissez\\nleur adresse mail dans le champ et appuyez sur Entrée (un mail leur sera envoyé)&nbsp;:\",\n    \"modal send mails\": \"Envoyer une notification\",\n    \"modal next\": \"Suivant\",\n    \"modal prev\": \"Précédent\",\n    \"modal ok\": \"Ok\",\n    \"modal cancel\": \"Annuler\",\n    \"modal error\": \"Erreur\",\n    \"only you can see\": \"Seuls vous et les personnes ci-dessous peuvent accéder à cette ressource.\",\n    \"shared\": \"Partagé\",\n    \"share\": \"Partager\",\n    \"save\": \"Sauvegarder\",\n    \"see link\": \"Voir le lien\",\n    \"send mails question\": \"Envoyer un email de notification à :\",\n    \"sharing\": \"Partage\",\n    \"revoke\": \"Révoquer la permission\",\n    \"confirm\": \"Confirmer\",\n    \"share forgot add\": \"Il semble que vous ayez oublié d'appuyer sur le bouton Ajouter\",\n    \"share confirm save\": \"Les changements effectués sur les permissions ne seront pas sauvegardés. Vous confirmez ?\",\n    \"yes forgot\": \"Retour\",\n    \"no forgot\": \"Ok\",\n    \"perm\": \"peut\",\n    \"perm r album\": \"parcourir cet album\",\n    \"perm rw album\": \"parcourir cet album et ajouter des photos\",\n    \"mail not send\": \"Le message n'a pas pu être envoyé\",\n    \"server error occured\": \"Une erreur est survenue sur le serveur, veuillez réessayer\",\n    \"change notif\": \"Cocher cette case pour recevoir une notification cozy quand un contact\\n ajoute une photo à cet album.\",\n    \"send email hint\": \"Des emails de notification seront envoyés lors de la première sauvegarde.\",\n    \"yes\": \"Oui\",\n    \"no\": \"Non\",\n    \"picture\": \"photo |||| photos\",\n    \"delete empty album\": \"L'album est vide, voulez-vous le supprimer?\",\n    \"are you sure you want to delete this album\": \"Voulez-vous vraiment effacer cet album ?\",\n    \"photos search\": \"Recherche des photos...\",\n    \"no photos found\": \"Aucune photo trouvée...\",\n    \"thumb creation\": \"L'application est en train de créer des miniatures pour vos photos afin d'améliorer votre navigation.\",\n    \"progress\": \"Progression\",\n    \"Navigate before upload\": \"Certaines photos n'ont pas encore été envoyées au serveur, voulez-vous vraiment quitter cette page ?\",\n    \"application title\": \"Cozy - photos\",\n    \"photo delete confirm\": \"Voulez-vous vraiment supprimer cette photo ?\"\n}\n;","PhotoCollection = require 'collections/photo'\nclient = require \"../lib/client\"\n\n# An album\n# Properties :\n# - photos : a PhotoCollection of the photo in this album\n# maintains attribute\n\nmodule.exports = class Album extends Backbone.Model\n\n    urlRoot: 'albums'\n\n    defaults: ->\n        title: ''\n        description: ''\n        clearance: []\n        thumbsrc: 'img/nophotos.gif'\n        orientation: 1\n        updated: null\n\n    url: -> super + app.urlKey\n\n    constructor: ->\n        @photos = new PhotoCollection()\n        return super\n\n    # Build orientation and cover thumb src from photo attribute/\n    parse: (attrs) ->\n\n        if attrs.photos?.length > 0\n            @photos.reset attrs.photos, parse: true\n        delete attrs.photos\n\n\n        if attrs.coverPicture and attrs.coverPicture isnt 'null'\n            attrs.thumb = attrs.coverPicture\n            attrs.thumbsrc = \"photos/thumbs/#{attrs.coverPicture}.jpg\"\n            if @photos.get(attrs.coverPicture)?.attributes?.orientation?\n                attrs.orientation =\n                    @photos._byId[attrs.coverPicture].attributes.orientation\n\n        if attrs.clearance is 'hidden'\n            attrs.clearance = 'public'\n\n        if attrs.clearance is 'private'\n            attrs.clearance = []\n\n        return attrs\n\n    # Build cover thumb src from coverPicture field.\n    getThumbSrc: ->\n        coverPicture = @get 'coverPicture'\n        if coverPicture?\n            thumbSrc = \"photos/thumbs/#{@get 'coverPicture'}.jpg\"\n        else\n            thumbSrc = \"img/nophotos.gif\"\n        return thumbSrc + app.urlKey\n\n    getPublicURL: (key) ->\n        urlKey = if key then \"?key=#{key}\" else \"\"\n        \"#{window.location.origin}/public/photos/#{urlKey}#albums/#{@id}\"\n\n    # Send sharing email for this album.\n    sendMail: (url, mails, callback) ->\n        data =\n            url: url\n            mails: mails\n        client.post \"albums/share\", data, callback\n","client = require('../lib/client')\n\n# A photo\n# maintains attributes src / thumbsrc depending of the state of the model\nmodule.exports = class Photo extends Backbone.Model\n\n    defaults: ->\n        thumbsrc: 'img/loading.gif'\n        src: ''\n        orientation: 1\n        gps: {}\n\n    url: ->\n        super + app.urlKey\n\n    # build img src attributes from id.\n    parse: (attrs) ->\n        if not attrs.id then attrs\n        else _.extend attrs,\n            thumbsrc: \"photos/thumbs/#{attrs.id}.jpg\" + app.urlKey\n            src: \"photos/#{attrs.id}.jpg\" + app.urlKey\n            orientation: attrs.orientation\n\n    # Return screen size photo src built from id.\n    getPrevSrc: ->\n        \"photos/#{@get 'id'}.jpg\"\n\nPhoto.listFromFiles = (page, callback)->\n    client.get \"files/#{page}\", callback\n\nPhoto.makeFromFile = (fileid, attr, callback) ->\n    client.post \"files/#{fileid}/toPhoto\", attr, callback\n","# read the file from photo.file using a FileReader\n# create photo.img : an Image object\nreadFile = (photo, next) ->\n    if photo.file.size > 50 * 1024 * 1024\n        return next t 'is too big (max 10Mo)'\n\n    if not photo.file.type.match /image\\/.*/\n        return next t 'is not an image'\n\n    reader = new FileReader()\n    photo.img = new Image()\n\n    reader.readAsDataURL photo.file\n    reader.onloadend = ->\n        photo.img.src = reader.result\n        photo.img.orientation = photo.attributes.orientation\n        photo.img.onload = ->\n            next()\n\n\n# resize an image into given dimensions\n# if fill, the image will be croped to fit in new dim\nresize = (photo, MAX_WIDTH, MAX_HEIGHT, fill) ->\n\n    max = width: MAX_WIDTH, height: MAX_HEIGHT\n    if (photo.img.width > photo.img.height) is fill\n        ratiodim = 'height'\n    else\n        ratiodim = 'width'\n\n    ratio = max[ratiodim] / photo.img[ratiodim]\n\n    newdims =\n        height: ratio * photo.img.height\n        width: ratio * photo.img.width\n\n    # use canvas to resize the image\n    canvas = document.createElement 'canvas'\n    canvas.width  = if fill then MAX_WIDTH  else newdims.width\n    canvas.height = if fill then MAX_HEIGHT else newdims.height\n    ctx = canvas.getContext '2d'\n    ctx.drawImage photo.img, 0, 0, newdims.width, newdims.height\n    return canvas.toDataURL photo.file.type\n\n\n# transform a dataUrl into a Blob\nblobify = (dataUrl, type) ->\n    binary = atob dataUrl.split(',')[1]\n    array = []\n    for i in [0..binary.length]\n        array.push binary.charCodeAt i\n    return new Blob [new Uint8Array(array)], type: type\n\n\n# create photo.thumb_du : a DataURL encoded thumbnail of photo.img\nmakeThumbDataURI = (photo, next) ->\n    photo.thumb_du = resize photo, 300, 300, true\n\n    photo.trigger 'thumbed'\n    next()\n\n\n# create photo.screen_du : a DataURL encoded thumbnail of photo.img\nmakeScreenDataURI = (photo, next) ->\n    photo.screen_du = resize photo, 1200, 800, false\n    next()\n\n\n# create photo.thumb : a Blob(~File) copy of photo.thumb_du\nmakeScreenBlob = (photo, next) ->\n    photo.thumb = blobify photo.thumb_du, photo.file.type\n    next()\n\n\n# create photo.screen : a Blob(~File) copy of photo.screen_du\nmakeThumbBlob = (photo, next) ->\n    photo.screen = blobify photo.screen_du, photo.file.type\n    next()\n\n\n# create a FormData object with photo.file, photo.thumb, photo.screen\n# save the model with these files\nupload = (photo, next) ->\n    formdata = new FormData()\n    for attr in ['title', 'description', 'albumid', 'orientation']\n        formdata.append attr, photo.get attr\n\n    formdata.append 'raw', photo.file\n    formdata.append 'thumb', photo.thumb, \"thumb_#{photo.file.name}\"\n    formdata.append 'screen', photo.screen, \"screen_#{photo.file.name}\"\n\n    # need to call sync directly so we can change the data\n    Backbone.sync 'create', photo,\n        contentType: false # Prevent $.ajax from being smart\n        data: formdata\n        success: (data) ->\n            photo.set photo.parse(data), silent: true\n            next()\n        error: ->\n            next t ' : upload failled' # clear tmps anyway\n        xhr: -> # add progress listener to XHR\n            xhr = $.ajaxSettings.xhr()\n            progress = (e) -> photo.trigger 'progress', e\n\n            if xhr instanceof window.XMLHttpRequest\n                xhr.addEventListener 'progress', progress, false\n            if xhr.upload\n                xhr.upload.addEventListener 'progress', progress, false\n            xhr\n\n\n# make screen sized version and upload\nuploadWorker = (photo, done) ->\n    async.waterfall [\n        (cb) -> readFile          photo, cb\n        (cb) -> makeThumbDataURI photo, cb\n        (cb) -> makeScreenDataURI photo, cb\n        (cb) -> makeScreenBlob    photo, cb\n        (cb) -> makeThumbBlob     photo, cb\n        (cb) -> upload            photo, cb\n        (cb) ->\n            # the photo is now backed by the server\n            # delete all object attached to the photo\n            delete photo.file\n            delete photo.img\n            delete photo.thumb\n            delete photo.thumb_du\n            delete photo.scren\n            delete photo.screen_du\n            setTimeout cb, 200\n    ], (err) ->\n        if err\n            photo.trigger 'upError', err\n        else\n            photo.trigger 'uploadComplete'\n\n        done err\n\n\nclass PhotoProcessor\n\n    # upload 2 by 2\n    uploadQueue: async.queue uploadWorker, 2\n\n    process: (photo) ->\n        @uploadQueue.push photo, (err) ->\n            return console.log err if err\n\nmodule.exports = new PhotoProcessor()\n","# Create an image node to get thumb prev data\nreadFile = (photo, next) ->\n\n    photo.img = new Image()\n    photo.img.onload = ->\n        next()\n    photo.img.src = photo.url\n\n\n# resize an image into given dimensions\n# if fill, the image will be croped to fit in new dim\nresize = (photo, MAX_WIDTH, MAX_HEIGHT, fill) ->\n\n    max = width: MAX_WIDTH, height: MAX_HEIGHT\n    if (photo.img.width > photo.img.height) is fill\n        ratiodim = 'height'\n    else\n        ratiodim = 'width'\n\n    ratio = max[ratiodim] / photo.img[ratiodim]\n\n    newdims =\n        height: ratio * photo.img.height\n        width: ratio * photo.img.width\n\n    # use canvas to resize the image\n    canvas = document.createElement 'canvas'\n    canvas.width  = if fill then MAX_WIDTH  else newdims.width\n    canvas.height = if fill then MAX_HEIGHT else newdims.height\n    ctx = canvas.getContext '2d'\n    ctx.drawImage photo.img, 0, 0, newdims.width, newdims.height\n    return canvas.toDataURL photo.file.type\n\n# transform a dataUrl into a Blob\nblobify = (dataUrl, type) ->\n    binary = atob dataUrl.split(',')[1]\n    array = []\n    for i in [0..binary.length]\n        array.push binary.charCodeAt i\n    return new Blob [new Uint8Array(array)], type: type\n\n\n# create photo.thumb_du : a DataURL encoded thumbnail of photo.img\nmakeThumbDataURI = (photo, next) ->\n    photo.thumb_du = resize photo, 300, 300, true\n    setTimeout next, 1\n\n# create photo.screen : a Blob(~File) copy of photo.screen_du\nmakeThumbBlob = (photo, next) ->\n    photo.thumb = blobify photo.thumb_du, photo.file.type\n    setTimeout next, 1\n\n\n# create a FormData object with photo.file, photo.thumb, photo.screen\n# save the model with these files\nupload = (photo, next) ->\n    formdata = new FormData()\n    formdata.append 'thumb', photo.thumb, \"thumb_#{photo.file.name}\"\n    $.ajax\n        url: \"photos/thumbs/#{photo.id}.jpg\"\n        data: formdata\n        cache: false\n        contentType: false\n        processData: false\n        type: 'PUT',\n        success: (data) ->\n            $(\"#rebuild-th\").append \"<p>#{photo.file.name} photo updated.</p>\"\n\n\n\n# make thumb and upload\nuploadWorker = (photo, done) ->\n    async.waterfall [\n        (cb) -> readFile          photo, cb\n        (cb) -> makeThumbDataURI photo, cb\n        (cb) -> makeThumbBlob     photo, cb\n        (cb) -> upload            photo, cb\n        (cb) ->\n            delete photo.img\n            delete photo.thumb\n            delete photo.thumb_du\n            cb()\n    ], (err) ->\n        done(err)\n\n\nclass ThumbProcessor\n\n    # upload 2 by 2\n    uploadQueue: async.queue uploadWorker, 2\n\n    process: (model) ->\n\n        photo =\n            url: model.getPrevSrc()\n            id: model.get 'id'\n            file:\n                type: 'image/jpeg'\n                name: model.get 'title'\n\n        #setTimeout =>\n            #@uploadQueue.push photo, (err) =>\n                #return console.log err if err\n        #, 300\n        uploadWorker photo, (err) ->\n            console.log err if err\n\n\nmodule.exports = new ThumbProcessor()\n","app             = require 'application'\nAlbumsListView  = require 'views/albumslist'\nAlbumView       = require 'views/album'\nMapView         = require 'views/map'\nAlbum           = require 'models/album'\nPhotoCollection = require 'collections/photo'\nAlbumCollection = require 'collections/album'\n\nmodule.exports = class Router extends Backbone.Router\n    routes:\n        ''                    : 'albumslist'\n        'albums'              : 'albumslist'\n        'albums/edit'         : 'albumslistedit'\n        'albums/new'          : 'newalbum'\n        'albums/:albumid'     : 'album'\n        'albums/:albumid/edit': 'albumedit'\n        'albums/:albumid/photo/:photoid': 'photo'\n        'albums/:albumid/edit/photo/:photoid': 'photoedit'\n#MODIF:remi\n        'map': 'showmap'\n\n    # display the \"map\" page\n    showmap: ->\n        allphotos = new PhotoCollection\n        allphotos.fetch  {reset:true}\n\n        @displayView new MapView\n            collection: allphotos\n\n    # display the \"home\" page : list of albums\n    albumslist: (editable=false)->\n        @displayView new AlbumsListView\n            collection: app.albums.sort()\n            editable: editable\n\n    # display the list of albums in edit mode\n    albumslistedit: ->\n        return @navigate 'albums', true if app.mode is 'public'\n        @albumslist true\n\n    # display the album view for an album with given id\n    # fetch before displaying it\n    album: (id, editable=false, callback) ->\n        if @mainView?.model?.get('id') is id\n\n            if editable\n                @mainView.makeEditable()\n            else\n                @mainView.makeNonEditable()\n\n            if callback\n                callback()\n            else\n                @mainView.closeGallery()\n\n        else\n            album = app.albums.get(id) or new Album id: id\n            album.fetch()\n                .done =>\n                    @displayView new AlbumView\n                        model: album\n                        editable: editable\n\n                    if callback\n                        callback()\n                    else\n                        @mainView.closeGallery()\n\n                .fail =>\n                    alert t 'this album does not exist'\n                    @navigate 'albums', true\n\n\n    # Display given photo from given album (non edit mode).\n    photo: (albumid, photoid) ->\n        @album albumid, false, =>\n            @mainView.showPhoto photoid\n\n\n    # Display given photo from given album (edit mode).\n    photoedit: (albumid, photoid) ->\n        @album albumid, true, =>\n            @mainView.showPhoto photoid\n\n\n    # display the album view in edit mode\n    albumedit: (id) ->\n        return @navigate 'albums', true if app.mode is 'public'\n        @album id, true\n        setTimeout ->\n            $('#title').focus()\n        , 200\n\n    # display the album view for a new Album\n    newalbum: ->\n        return @navigate 'albums', true if app.mode is 'public'\n        window.app.albums.create {},\n            success: (model) =>\n                @navigate \"albums/#{model.id}/edit\", true\n            error: =>\n                @navigate \"albums\", true\n\n    # display a page properly (remove previous page)\n    displayView: (view) =>\n        @mainView.remove() if @mainView\n        @mainView = view\n\n        el = @mainView.render().$el\n        el.addClass \"mode-#{app.mode}\"\n        $('body').append el\n\n    hashChange: (event) =>\n        if @cancelNavigate\n            event.stopImmediatePropagation()\n            @cancelNavigate = false\n        else\n\n            # default window title\n            document.title = t 'application title'\n\n            if @mainView and @mainView.dirty\n                if not(window.confirm t(\"Navigate before upload\"))\n                    event.stopImmediatePropagation()\n                    @cancelNavigate = true\n                    window.location.href = event.originalEvent.oldURL\n                else\n                    @mainView.dirty = false\n\n    beforeUnload: (event) =>\n        if @mainView and @mainView.dirty\n            # Chrome will display this message, Firefox won't\n            confirm = t(\"Navigate before upload\")\n        else\n            confirm = undefined\n        event.returnValue = confirm\n        return confirm\n","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),id = locals_.id,downloadPath = locals_.downloadPath,photosNumber = locals_.photosNumber,clearance = locals_.clearance,title = locals_.title,description = locals_.description;\nbuf.push(\"<div id=\\\"about\\\"><div class=\\\"clearfix\\\"><div id=\\\"links\\\" class=\\\"clearfix\\\"><p class=\\\"back\\\"><a href=\\\"#albums\\\" class=\\\"flatbtn\\\"><span class=\\\"fa fa-arrow-left icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"Back\")) ? \"\" : jade_interp)) + \"</span></a></p><p class=\\\"startediting\\\"><a\" + (jade.attr(\"href\", \"#albums/\" + (id) + \"/edit\", true, false)) + \" class=\\\"flatbtn\\\"><span class=\\\"fa fa-edit icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"Edit\")) ? \"\" : jade_interp)) + \"</span></a></p><p class=\\\"stopediting\\\"><a\" + (jade.attr(\"href\", \"#albums/\" + (id) + \"\", true, false)) + \" class=\\\"flatbtn stopediting\\\"><span class=\\\"fa fa-save icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"Stop editing\")) ? \"\" : jade_interp)) + \"</span></a></p><p class=\\\"download\\\"><a\" + (jade.attr(\"href\", \"\" + (downloadPath) + \"\", true, false)) + \" class=\\\"flatbtn\\\"><span class=\\\"fa fa-download icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"Download\")) ? \"\" : jade_interp)) + \"</span></a></p><p class=\\\"delete\\\"><a class=\\\"flatbtn delete\\\"><span class=\\\"fa fa-trash icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"Delete\")) ? \"\" : jade_interp)) + \"</span></a></p><p class=\\\"clearance\\\"><a class=\\\"flatbtn clearance\\\"><span class=\\\"fa fa-share-alt icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"share\")) ? \"\" : jade_interp)) + \"</span></a></p></div><div id=\\\"album-text\\\"><div id=\\\"album-text-background\\\"><div class=\\\"right\\\"><p><span class=\\\"photo-number\\\">\" + (jade.escape(null == (jade_interp = photosNumber) ? \"\" : jade_interp)) + \"</span><br/><span class=\\\"photo-count\\\">\" + (jade.escape(null == (jade_interp = t(\"picture\", {smart_count: photosNumber})) ? \"\" : jade_interp)) + \"</span></p></div><form class=\\\"left\\\"><div><span class=\\\"clearance-state\\\">\");\nif ( clearance == 'public')\n{\nbuf.push(\"<span class=\\\"fa fa-globe\\\"></span>&nbsp;\\n\" + (jade.escape((jade_interp = t('shared')) == null ? '' : jade_interp)) + \"\");\n}\nelse if ( clearance && clearance.length > 0)\n{\nbuf.push(\"<span class=\\\"fa fa-share-alt\\\"></span>&nbsp;\\n\" + (jade.escape((jade_interp = t('shared')) == null ? '' : jade_interp)) + \"\");\nif ( clearance.length)\n{\nbuf.push(\"<span>&nbsp;(\" + (jade.escape((jade_interp = clearance.length) == null ? '' : jade_interp)) + \")</span>\");\n}\n}\nbuf.push(\"</span></div><input id=\\\"title\\\" type=\\\"text\\\"\" + (jade.attr(\"placeholder\", \"\" + (t('title placeholder')) + \"\", true, false)) + (jade.attr(\"value\", title, true, false)) + \"/><textarea id=\\\"description\\\"\" + (jade.attr(\"placeholder\", \"\" + (t('description placeholder')) + \"\", true, false)) + \">\" + (null == (jade_interp = description) ? \"\" : jade_interp) + \"</textarea><div id=\\\"publicDesc\\\">\" + (jade.escape(null == (jade_interp = description) ? \"\" : jade_interp)) + \"</div></form></div></div></div></div><div id=\\\"photos\\\" class=\\\"clearfix\\\"></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<a id=\\\"create-album-link\\\" href=\\\"#albums/new\\\" class=\\\"create\\\"><span>\" + (jade.escape(null == (jade_interp = t('Create a new album')) ? \"\" : jade_interp)) + \"</span></a><a href=\\\"#map\\\" class=\\\"create map-link\\\"><i class=\\\"fa fa-globe\\\"></i></a><p class=\\\"help\\\">\" + (jade.escape(null == (jade_interp = t('There is no public albums.')) ? \"\" : jade_interp)) + \"</p>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),id = locals_.id,isRecent = locals_.isRecent,thumbsrc = locals_.thumbsrc,folderid = locals_.folderid,title = locals_.title;\nbuf.push(\"<a\" + (jade.attr(\"id\", \"\" + (id) + \"\", true, false)) + (jade.attr(\"href\", \"#albums/\" + (id) + \"\", true, false)) + (jade.cls([isRecent], [true])) + \"><img\" + (jade.attr(\"src\", \"\" + (thumbsrc) + \"\", true, false)) + \"/><span class=\\\"title\\\">\");\nif ( folderid == \"all\")\n{\nbuf.push(jade.escape(null == (jade_interp = title) ? \"\" : jade_interp));\n}\nelse\n{\nbuf.push(\"<b>\" + (jade.escape(null == (jade_interp = title) ? \"\" : jade_interp)) + \"</b>\");\n}\nbuf.push(\"</span></a>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),dates = locals_.dates,hasPrev = locals_.hasPrev,hasNext = locals_.hasNext,photos = locals_.photos;\nbuf.push(\"<div class=\\\"files\\\">\");\nif ( dates.length === 0)\n{\nbuf.push(\"<p>\" + (jade.escape(null == (jade_interp = t(\"photos search\")) ? \"\" : jade_interp)) + \"</p>\");\n}\nelse if ( dates === \"No photos found\")\n{\nbuf.push(\"<p>\" + (jade.escape(null == (jade_interp = t(\"no photos found\")) ? \"\" : jade_interp)) + \"</p>\");\n}\nelse\n{\nbuf.push(\"<nav><ul>\");\nif ( hasPrev)\n{\nbuf.push(\"<li><a class=\\\"btn btn-cozy prev\\\"><i class=\\\"fa fa-angle-left\\\"></i><span>\" + (jade.escape((jade_interp = t('modal prev')) == null ? '' : jade_interp)) + \"</span></a></li>\");\n}\nif ( hasNext)\n{\nbuf.push(\"<li><a class=\\\"btn btn-cozy next\\\"><span>\" + (jade.escape((jade_interp = t('modal next')) == null ? '' : jade_interp)) + \"</span><i class=\\\"fa fa-angle-right\\\"></i></a></li>\");\n}\nbuf.push(\"</ul></nav><dl>\");\n// iterate dates\n;(function(){\n  var $$obj = dates;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var date = $$obj[$index];\n\nbuf.push(\"<dt>\" + (jade.escape((jade_interp = t(date.split('-')[1])) == null ? '' : jade_interp)) + \" \" + (jade.escape((jade_interp = date.split('-')[0]) == null ? '' : jade_interp)) + \"</dt><dd><ul class=\\\"thumbs\\\">\");\n// iterate photos[date]\n;(function(){\n  var $$obj = photos[date];\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var photo = $$obj[$index];\n\nbuf.push(\"<li><img\" + (jade.attr(\"src\", \"files/thumbs/\" + (photo.id) + \".jpg\", true, false)) + (jade.attr(\"id\", \"\" + (photo.id) + \"\", true, false)) + \"/></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var photo = $$obj[$index];\n\nbuf.push(\"<li><img\" + (jade.attr(\"src\", \"files/thumbs/\" + (photo.id) + \".jpg\", true, false)) + (jade.attr(\"id\", \"\" + (photo.id) + \"\", true, false)) + \"/></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></dd>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var date = $$obj[$index];\n\nbuf.push(\"<dt>\" + (jade.escape((jade_interp = t(date.split('-')[1])) == null ? '' : jade_interp)) + \" \" + (jade.escape((jade_interp = date.split('-')[0]) == null ? '' : jade_interp)) + \"</dt><dd><ul class=\\\"thumbs\\\">\");\n// iterate photos[date]\n;(function(){\n  var $$obj = photos[date];\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var photo = $$obj[$index];\n\nbuf.push(\"<li><img\" + (jade.attr(\"src\", \"files/thumbs/\" + (photo.id) + \".jpg\", true, false)) + (jade.attr(\"id\", \"\" + (photo.id) + \"\", true, false)) + \"/></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var photo = $$obj[$index];\n\nbuf.push(\"<li><img\" + (jade.attr(\"src\", \"files/thumbs/\" + (photo.id) + \".jpg\", true, false)) + (jade.attr(\"id\", \"\" + (photo.id) + \"\", true, false)) + \"/></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></dd>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</dl><nav><ul>\");\nif ( hasPrev)\n{\nbuf.push(\"<li><a class=\\\"btn btn-cozy prev\\\"><i class=\\\"fa fa-angle-left\\\"></i><span>\" + (jade.escape((jade_interp = t('modal prev')) == null ? '' : jade_interp)) + \"</span></a></li>\");\n}\nif ( hasNext)\n{\nbuf.push(\"<li><a class=\\\"btn btn-cozy next\\\"><span>\" + (jade.escape((jade_interp = t('modal next')) == null ? '' : jade_interp)) + \"</span><i class=\\\"fa fa-angle-right\\\"></i></a></li>\");\n}\nbuf.push(\"</ul></nav>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<p class=\\\"help\\\">\" + (jade.escape(null == (jade_interp = t('There is no photos in this album')) ? \"\" : jade_interp)) + \"</p><div id=\\\"upload-actions\\\"><div id=\\\"upload-block\\\" class=\\\"flatbtn\\\"><input id=\\\"uploader\\\" type=\\\"file\\\" multiple=\\\"multiple\\\"/><div class=\\\"pa2\\\">\" + (jade.escape(null == (jade_interp = t('pick from computer')) ? \"\" : jade_interp)) + \"</div></div><div id=\\\"browse-files\\\" class=\\\"flatbtn\\\"><div class=\\\"pa2\\\">\" + (jade.escape(null == (jade_interp = t('pick from files')) ? \"\" : jade_interp)) + \"</div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div style=\\\"position: fixed; height:100%; width: 100%;\\\"><div id=\\\"links\\\" style=\\\"margin-bottom:0;\\\"><a href=\\\"#\\\" class=\\\"flatbtn\\\"><span class=\\\"fa fa-arrow-left icon-white\\\"></span><span>\" + (jade.escape(null == (jade_interp = t(\"Back\")) ? \"\" : jade_interp)) + \"</span></a></div><div id=\\\"map\\\" style=\\\"height: 95%;\\\"></div></div><form style=\\\"position: fixed; bottom: 0; width: 100%; height:0; background-color: white; transisiton: all 0.5 linear\\\" class=\\\"choice-box\\\"><div id=\\\"map-galery\\\" style=\\\"overflow-x: scroll; padding: 0; white-space: nowrap;\\\" class=\\\"col-sm-10\\\"></div><div style=\\\"padding: 0;\\\" class=\\\"map-setter col-sm-2\\\"><div class=\\\"clearfix\\\"><div id=\\\"links\\\" class=\\\"clearfix\\\"><p class=\\\"back\\\"><button id=\\\"validate\\\" class=\\\"flatbtn\\\"><span>\" + (jade.escape(null == (jade_interp = t(\"Apply\")) ? \"\" : jade_interp)) + \"</span></button></p></div></div></div></form><img hidden src=\\\"images/spinner.svg\\\" width=\\\"100%\\\", height=\\\"100%\\\" title=\\\"waiting...\\\" />\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),src = locals_.src,title = locals_.title,thumbsrc = locals_.thumbsrc;\nbuf.push(\"<a\" + (jade.attr(\"href\", \"\" + (src) + \"\", true, false)) + (jade.attr(\"title\", \"\" + (title) + \"\", true, false)) + \"><img\" + (jade.attr(\"data-src\", \"\" + (thumbsrc) + \"\", true, false)) + (jade.attr(\"alt\", \"\" + (title) + \"\", true, false)) + \"/><div class=\\\"progressfill\\\"></div></a><button class=\\\"delete flatbtn\\\"><i class=\\\"fa fa-times icon-white\\\"></i></button>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","app = require 'application'\n\nBaseView = require 'lib/base_view'\nGalery = require 'views/galery'\nClipboard = require 'lib/clipboard'\n\nthProcessor = require 'models/thumbprocessor'\nclipboard = new Clipboard()\n\nTAB_KEY_CODE = 9\n\n# On a public page, we don't need the Share modal.\n# Requiring modal_share_view triggers a request to get the contacts, and\n# the request will fail on public pages.\nif not window.location.pathname.match /public/\n    CozyClearanceModal = require 'cozy-clearance/modal_share_view'\n    class ShareModal extends CozyClearanceModal\n        initialize: ->\n            super\n            @refresh()\n\n        # override makeURL to append the key in the middle of the url\n        # see: models/album:getPublicURL\n        makeURL: (key) -> @model.getPublicURL key\n\n\nmodule.exports = class AlbumView extends BaseView\n    template: require 'templates/album'\n\n    id: 'album'\n    className: 'container-fluid'\n\n    events: =>\n        'click a.delete': @destroyModel\n        'click a.clearance': @changeClearance\n        'click a.sendmail': @sendMail\n        'click a#rebuild-th-btn': @rebuildThumbs\n        'click a.stopediting': @checkNew\n        'blur #title': @onTitleChanged\n        'blur #description': @onDescriptionChanged\n        'click #title': @onFieldClicked\n        'click #description': @onFieldClicked\n        'mousedown #title': @onFieldClicked\n        'mousedown #description': @onFieldClicked\n        'mouseup #title': @onFieldClicked\n        'mouseup #description': @onFieldClicked\n        'keydown #description': @onDescriptionKeyUp\n\n\n    initialize: (options) ->\n        super options\n\n        # debounce the call to `@onPhotoCollectionChange` to prevent spamming\n        # server with useless `PUT` on album just to update the `updated` date\n        # when bulk-adding items to collection.\n        onPhotoCollectionChange = _.debounce @onPhotoCollectionChange, 50\n        @listenTo @model.photos, 'add remove', onPhotoCollectionChange\n        @listenTo @model, 'change:clearance', @render\n\n    getRenderData: ->\n        key = $.url().param('key')\n        downloadPath = \"albums/#{@model.get 'id'}.zip\"\n        downloadPath += \"?key=#{key}\" if key?\n\n        res = _.extend\n            downloadPath: downloadPath\n            photosNumber: @model.photos.length\n        , @model.attributes\n        res\n\n    afterRender: ->\n\n        # Use title of album as window title\n        document.title = \"#{t 'application title'} - #{@model.get 'title'}\"\n\n        @title = @$ '#title'\n        @description = @$ '#description'\n        @publicDesc  = @$ '#publicDesc'\n\n        @galery = new Galery\n            el: @$ '#photos'\n            editable: @options.editable\n            collection: @model.photos\n            beforeUpload: @beforePhotoUpload\n\n        @galery.album = @model\n        @galery.render()\n\n        if @options.editable\n            @makeEditable()\n            @publicDesc.hide()\n        else\n            @title.addClass 'disabled'\n            @description.hide()\n            @publicDesc.show()\n\n\n    beforePhotoUpload: (callback) =>\n        callback albumid: @model.id\n\n    onTitleChanged: =>\n        @saveModel title: @title.val().trim()\n\n    onDescriptionChanged: =>\n        @saveModel description: @description.val().trim()\n\n    makeEditable: =>\n        document.title = \"#{t 'application title'} - #{@model.get 'title'}\"\n        @$el.addClass 'editing'\n        @options.editable = true\n        @galery.options.editable = true\n        @description.show()\n        @publicDesc.hide()\n\n    makeNonEditable: =>\n        document.title = \"#{t 'application title'} - #{@model.get 'title'}\"\n        @$el.removeClass 'editing'\n        @options.editable = false\n        @galery.options.editable = false\n        @description.hide()\n        @publicDesc.show()\n\n    onFieldClicked: (event) =>\n        unless @options.editable\n            event.preventDefault()\n            false\n\n    # Ask for confirmation if album is not new.\n    destroyModel: ->\n        if confirm t \"are you sure you want to delete this album\"\n            @model.destroy().then ->\n                app.router.navigate 'albums', true\n\n    checkNew: (event) =>\n        if @model.get('title') is '' and\n           @model.get('description') is '' and\n           @model.photos.length is 0\n            if confirm t 'delete empty album'\n                event.preventDefault()\n                @model.destroy().then ->\n                    app.router.navigate 'albums', true\n        true\n\n    # Change sharing state of the album.\n    changeClearance: (event) =>\n        @model.set 'clearance', [] unless @model.get('clearance')?\n        @model.set 'type', 'album'\n        new ShareModal\n            model: @model\n\n    # Temporary tool to allow people to rebuild the thumbnails with size\n    # set recently. New size is larger, so older thumbs looks blurry.\n    # This function recalculate them with the right size\n    rebuildThumbs: (event) ->\n        $(\"#rebuild-th p\").remove()\n        models = @model.photos.models\n\n        recFunc = ->\n            if models.length > -1\n                model = models.pop()\n                setTimeout ->\n                    thProcessor.process model\n                    recFunc()\n                , 500\n        recFunc()\n\n    onDescriptionKeyUp: (event) ->\n        if TAB_KEY_CODE in [event.keyCode, event.which]\n            $('.stopediting').focus()\n\n    saveModel: (data) ->\n        data.updated = Date.now()\n        @model.save data\n\n    onPhotoCollectionChange: =>\n        @model.save updated: Date.now()\n        # updates the photo counter\n        @$('.photo-number').html @model.photos.length\n        @$('.photo-count').html t(\"picture\", {smart_count: @model.photos.length})\n\n    # Force display of given photo.\n    showPhoto: (photoid) ->\n        @galery.showPhoto photoid\n\n    # Force galery to close.\n    closeGallery: ->\n        @galery.closePhotobox()\n\n","ViewCollection = require 'lib/view_collection'\napp = require 'application'\n\n# \"Home\" view : the list of album\n# simple ViewCollection\n# pass editable options to children\n\nmodule.exports = class AlbumsList extends ViewCollection\n    id: 'album-list'\n    itemView: require 'views/albumslist_item'\n    template: require 'templates/albumlist'\n\n    initialize: ->\n        super\n\n    checkIfEmpty: =>\n        @$('.help').toggle _.size(@views) is 0 and app.mode is 'public'\n\n    afterRender: ->\n        super\n","BaseView = require 'lib/base_view'\n{limitLength} = require 'lib/helpers'\nhelpers = require 'lib/helpers'\n\n# Item View for the albums list\nmodule.exports = class AlbumItem extends BaseView\n    className: 'albumitem'\n    template: require 'templates/albumlist_item'\n\n    initialize: ->\n        @listenTo @model, 'change', => @render()\n\n    getRenderData: ->\n        out = _.clone @model.attributes\n        out.description = limitLength out.description, 250\n        out.thumbsrc =  @model.getThumbSrc()\n        # Album is recent if it has been updated in less than 60s\n        out.isRecent = if (out.updated? and out.updated - Date.now() < 60000) then 'recent' else ''\n        return out\n\n    afterRender: ->\n        @image = @$ 'img'\n        @image.attr 'src', @model.getThumbSrc()\n        helpers.rotate @model.attributes.orientation, @image\n        # remove loading background one image is loaded\n        if @image.get(0).complete\n            @onImageLoaded()\n        else\n            @image.on 'load', =>\n                @onImageLoaded()\n\n    onImageLoaded: ->\n        @image.addClass 'loaded'\n","Modal = require 'cozy-clearance/modal'\nPhoto = require '../models/photo'\n\n\nmodule.exports = class FilesBrowser extends Modal\n\n    id: 'files-browser-modal'\n    template_content: require '../templates/browser'\n    title: t 'pick from files'\n    content: '<p>Loading ...</p>'\n\n    events: -> _.extend super,\n        'click img': 'toggleSelected'\n        'click a.next': 'displayNextPage'\n        'click a.prev': 'displayPrevPage'\n\n    toggleSelected: (e) ->\n        $el = $(e.target)\n        # Get the index of the selected element in the list\n        index = $el.parent().index()\n        # If shiftKey is pressed, then select the whole range of items\n        # between the last selected element and the current one\n        if @lastSelectedIndex? and e.shiftKey\n            if index > @lastSelectedIndex\n                first = @lastSelectedIndex\n                last = index\n            else if index < @lastSelectedIndex\n                first = index\n                last = @lastSelectedIndex\n            # Filter all elements to get those in range and select it too\n            @$('.thumbs li')\n            .filter (index) ->\n                return first <= index <= last\n            .find('img').addClass 'selected'\n        else\n            $el.toggleClass 'selected'\n        @lastSelectedIndex = index\n\n    getRenderData: -> @options\n\n    initialize: (options) ->\n        @yes = t 'modal ok'\n        @no = t 'modal cancel'\n\n        # stores index of the last selected element for range select w/ shiftKey\n        @lastSelectedIndex = null\n\n        # Prepare option\n        if not options.page?\n            super {}\n\n        if not options.page?\n            options.page = 0\n\n        if not options.selected?\n            @options.selected = []\n\n        @options.page = options.page\n\n        # Recover files\n        Photo.listFromFiles options.page, (err, body) =>\n            dates = body.files if body?.files?\n\n            if err\n                return console.log err\n\n            # If there is no photos in Cozy\n            else if dates? and Object.keys(dates).length is 0\n                @options.dates = \"No photos found\"\n\n            else\n                # Add next/prev button\n                @options.hasNext = body.hasNext if body?.hasNext?\n                @options.hasPrev = options.page isnt 0\n                @options.dates = Object.keys dates\n                @options.dates.sort (a, b) ->\n                    -1 * a.localeCompare b\n                @options.photos = dates\n\n            @$('.modal-body').html @template_content @getRenderData()\n            @$('.modal-body').scrollTop(0)\n            # Add selected files\n            if @options.selected[@options.page]?\n                for img in @options.selected[@options.page]\n                    @$(\"##{img.id}\").toggleClass 'selected'\n\n\n    cb: (confirmed) ->\n        return unless confirmed\n        @options.beforeUpload (attrs) =>\n            # flatten selection of photos accross pages\n            @options.selected[@options.page] = @$('.selected')\n            sel = [].concat.apply [], @options.selected.map (jq) -> jq.get()\n\n            addImageToCollection = (img) ->\n                attrs.title = img.name\n                # creates a tmp version with the selected image from the browser\n                photo      = new Photo attrs\n                photo.file = img\n                # in the mean time, trigger an update to the server to get the\n                # final version of the image\n                Photo.makeFromFile img.id, attrs, (err, attributes) ->\n                    if err\n                        console.error err\n                    else\n                        photo.save attributes\n                return photo\n\n            # each (tmp) files processed, bulk-add them to the collection\n            @collection.add (addImageToCollection img for img in sel)\n\n\n    displayNextPage: ->\n        # Display next page: store selected files\n        @options.selected[@options.page] = @$('.selected')\n        options =\n            page: @options.page + 1\n            selected: @options.selected\n        @initialize options\n\n    displayPrevPage: ->\n        # Display prev page: store selected files\n        @options.selected[@options.page] = @$('.selected')\n        options =\n            page: @options.page - 1\n            selected: @options.selected\n        @initialize options\n\n","ViewCollection = require 'lib/view_collection'\nhelpers = require 'lib/helpers'\nFilesBrowser = require './browser'\nPhotoView = require 'views/photo'\nPhoto = require 'models/photo'\nphotoprocessor = require 'models/photoprocessor'\napp = require 'application'\n\n# galery : collection of PhotoViews\nmodule.exports = class Galery extends ViewCollection\n    itemView: PhotoView\n\n    template: require 'templates/galery'\n\n    # D&D events\n    events: ->\n        'drop'     : 'onFilesDropped'\n        'dragover' : 'onDragOver'\n        'dragleave' : 'onDragLeave'\n        # change isn't fired on first click ???\n        #'change #uploader': 'onFilesChanged'\n        'click #uploader': 'onFilesClick'\n        'click #browse-files': 'displayBrowser'\n\n\n    initialize: ->\n        @photoCount = 0\n        super\n        # when the cover picture is deleted, we remove it from the album\n        @listenTo @collection, 'destroy', @onPictureDestroyed\n\n\n    # Launch photobox after render.\n    afterRender: ->\n        super\n        @$el.photobox 'a.server',\n            thumbs: false\n            history: false\n            zoomable: false\n            beforeShow: @beforeImageDisplayed\n            afterClose: @onAfterClosed\n        , @onImageDisplayed\n\n        # Addition to photobox ui to give more control to the user.\n        if $('#pbOverlay .pbCaptionText .btn-group').length is 0\n            $('#pbOverlay .pbCaptionText')\n                .append('<div class=\"btn-group\"></div>')\n\n        # Add button to return photo to left\n        if app.mode isnt 'public'\n            @turnLeft = $('#pbOverlay .pbCaptionText .btn-group .left')\n            @turnLeft.unbind 'click'\n            @turnLeft.remove()\n            @turnLeft = $('<a id=\"left\" class=\"btn left\" type=\"button\">\n                         <i class=\"fa fa-undo\"> </i> </a>')\n                .appendTo '#pbOverlay .pbCaptionText .btn-group'\n            @turnLeft.on 'click', @onTurnLeft\n\n            # Add button to return photo to right\n            @turnRight = $('#pbOverlay .pbCaptionText .btn-group .right')\n            @turnRight.unbind 'click'\n            @turnRight.remove()\n            @turnRight = $('<a id=\"right\" class=\"btn right\">\n                           <i class=\"fa fa-repeat\" </i> </a>')\n                .appendTo '#pbOverlay .pbCaptionText .btn-group'\n            @turnRight.on 'click', @onTurnRight\n\n\n\n            # Cover button to select cover\n            @coverBtn = $('#pbOverlay .pbCaptionText .btn-group .cover-btn')\n            @coverBtn.unbind 'click'\n            @coverBtn.remove()\n            @coverBtn = $('<a id=\"cover-btn\" class=\"btn cover-btn\">\n                           <i class=\"fa fa-star\" </i> </a>')\n                .appendTo '#pbOverlay .pbCaptionText .btn-group'\n            @coverBtn.on 'click', @onCoverClicked\n\n            # Add button to delete photo\n            @trashBtn = $('#pbOverlay .pbCaptionText .btn-group .trash-btn')\n            @trashBtn.unbind 'click'\n            @trashBtn.remove()\n            @trashBtn = $('<a id=\"trash-btn\" class=\"btn trash-btn\">\n                           <i class=\"fa fa-trash\" </i> </a>')\n                .appendTo '#pbOverlay .pbCaptionText .btn-group'\n            @trashBtn.on 'click', @onTrashClicked\n\n\n        # Add link to download photo\n        @downloadLink = $('#pbOverlay .pbCaptionText .btn-group .download-link')\n        @downloadLink.unbind 'click'\n        @downloadLink.remove()\n        unless @downloadLink.length\n            @downloadLink =\n                $('<a class=\"btn download-link\" download>\n                  <i class=\"fa fa-download\"></i></a>')\n                .appendTo '#pbOverlay .pbCaptionText .btn-group'\n\n        @uploader = @$('#uploader')\n\n\n        if app.mode isnt 'public'\n            view.collection = @collection for key, view of @views\n\n\n    # Override addItem to display only 50 first photos. Then, displaying should\n    # be handled by unveil (lazy loading).\n    addItem: (model) =>\n        options = _.extend {}, {model: model}, @itemViewOptions(model)\n        view = new @itemView(options)\n\n        @views[model.cid] = view.render()\n        view.setSource() if @photoCount < 50\n        @photoCount++\n        @appendView view\n        @checkIfEmpty @views\n\n\n    checkIfEmpty: =>\n        @$('.help').toggle _.size(@views) is 0 and app.mode is 'public'\n\n\n    # event listeners for D&D events\n    onFilesDropped: (evt) ->\n        if @options.editable\n            @$el.removeClass 'dragover'\n            @handleFiles evt.dataTransfer.files\n            evt.stopPropagation()\n            evt.preventDefault()\n        return false\n\n\n    # Display orange background telling that drag is active.\n    onDragOver: (evt) ->\n        if @options.editable\n            @$el.addClass 'dragover'\n            evt.preventDefault()\n            evt.stopPropagation()\n        return false\n\n\n    onDragLeave: (evt) ->\n        if @options.editable\n            @$el.removeClass 'dragover'\n            evt.preventDefault()\n            evt.stopPropagation()\n        return false\n\n\n    # Extract photo id from its URL. It's useful to get the id of the current\n    # picture when the user browses them via photobox.\n    getIdPhoto: (url) ->\n        url ?= $('#pbOverlay .wrapper img').attr 'src'\n        parts = url.split('/')\n        id = parts[parts.length - 1]\n        id = id.split('.')[0]\n        # if collection has not been saved, we must search by url\n        if not @collection.get(id)?\n            photo = @collection.find (e) ->\n                return e.attributes.src.split('/').pop().split('.')[0] is id\n            if photo?\n                id = photo.cid\n        return id\n\n\n    # Rotate 90° left the picture by updating css and orientation.\n    # Save result to Cozy database.\n    onTurnLeft: () =>\n        id = @getIdPhoto()\n        orientation = @collection.get(id)?.attributes.orientation\n        orientation = 1 unless orientation?\n        newOrientation =\n            helpers.rotateLeft orientation, $('.wrapper img')\n        helpers.rotate newOrientation, $('.wrapper img')\n        @collection.get(id)?.save orientation: newOrientation,\n            success : () ->\n                helpers.rotate newOrientation, $('.pbThumbs .active img')\n\n\n    # Rotate 90° right the picture by updating css and orientation.\n    onTurnRight: () =>\n        id = @getIdPhoto()\n        orientation = @collection.get(id)?.attributes.orientation\n        newOrientation =\n            helpers.rotateRight orientation, $('.wrapper img')\n        helpers.rotate newOrientation, $('.wrapper img')\n        @collection.get(id)?.save orientation: newOrientation,\n            success : () ->\n                helpers.rotate newOrientation, $('.pbThumbs .active img')\n\n\n    # When cover button is clicked, the current picture is set on the current\n    # album as cover. Then information are saved.\n    onCoverClicked: () =>\n        @coverBtn.addClass 'disabled'\n        photoId = @getIdPhoto()\n        @album.set 'coverPicture', photoId\n        @album.set 'thumb', photoId\n        @album.set 'thumbsrc', @album.getThumbSrc()\n        @album.save null,\n            success: =>\n                @coverBtn.removeClass 'disabled'\n                alert t 'photo successfully set as cover'\n            error: =>\n                @coverBtn.removeClass 'disabled'\n                alert t 'problem occured while setting cover'\n\n\n    onPictureDestroyed: (destroyed) =>\n        if destroyed.id is @album.get 'coverPicture'\n            @album.save coverPicture: null\n\n\n    onFilesChanged: (evt) =>\n        @handleFiles @uploader[0].files\n        # reset the input\n        old = @uploader\n        @uploader = old.clone true\n        old.replaceWith @uploader\n\n\n    onFilesClick: (evt) ->\n        element = document.getElementById('uploader')\n        element.addEventListener 'change', @onFilesChanged\n\n\n    # When trash button is clicked it proposes to delete the currently\n    # displayed picture. It asks for a confirmation before\n    onTrashClicked: =>\n        if confirm t 'photo delete confirm'\n            photo = @collection.get(@getIdPhoto())\n            photo.destroy()\n\n\n    beforeImageDisplayed: (link) =>\n        id = @getIdPhoto link.href\n        orientation = @collection.get(id)?.attributes.orientation\n        $('#pbOverlay .wrapper img')[0].dataset.orientation = orientation\n\n\n    onImageDisplayed: =>\n        @isViewing = true\n        id = @getIdPhoto()\n\n        if @options.editable\n            app.router.navigate \"albums/#{@album.id}/edit/photo/#{id}\", false\n        else\n            app.router.navigate \"albums/#{@album.id}/photo/#{id}\", false\n\n        url = \"photos/raws/#{id}.jpg\"\n        @downloadLink.attr 'href', url\n\n        # Rotate thumbs\n        thumbs = $('#pbOverlay .pbThumbs img')\n        for thumb in thumbs\n            url = thumb.src\n            parts = url.split('/')\n            id = parts[parts.length - 1]\n            id = id.split('.')[0]\n            orientation = @collection.get(id)?.attributes.orientation\n            helpers.rotate orientation, $(thumb)\n\n\n    onAfterClosed: =>\n        @isViewing = false\n        if @options.editable\n            app.router.navigate \"albums/#{@album.id}/edit\", true\n        else\n            app.router.navigate \"albums/#{@album.id}\", true\n\n\n    # For each file, add a photo object to the galery, creates its thumbnails\n    # and save them to the server.\n    # When the process is finished, the first picture is set as the album cover\n    # if no cover is et.\n    handleFiles: (files) ->\n        # Set the view as dirty to warn users it will cancel the upload\n        # if he leaves the page during the upload.\n        app.router.mainView.dirty = true\n\n        # Prepare common attributes for all pictures.\n        @options.beforeUpload (photoAttributes) =>\n            @uploadCounter = 0\n\n            # Add a photo to the collection, to avoid browser freezing,\n            # after 20 pictures, it waits for 10ms (and release execution loop)\n            # before adding pictures to the collection and the view.\n            addPhotoAndBreath = (file, callback) =>\n                photo = @addPhoto file, photoAttributes\n\n                # When the first photo is uploaded, it is set as the album\n                # cover.\n                if @uploadCounter is 0\n                    photo.on 'uploadComplete', =>\n                        @setCoverPicture photo\n\n                if @uploadCounter > 20\n                    setTimeout callback, 10\n                else\n                    @uploadCounter++\n                    callback()\n\n            # Process all file creations\n            async.eachSeries files, addPhotoAndBreath, =>\n\n                # save reference to the collection on each view.\n                view.collection = @collection for key, view of @views\n                app.router.mainView.dirty = false\n\n\n    # Add photo to current collection and enqueue its remote creation.\n    addPhoto: (file, photoAttributes) =>\n        photoAttributes.title = file.name\n        photo = new Photo photoAttributes\n        photo.file = file\n\n        @collection.add photo\n        photoprocessor.process photo\n\n        photo\n\n\n    # Set the first picture of the galery as the cover picture of the album.\n    setCoverPicture: (photo) =>\n        unless @album.get('coverPicture')?\n            @album.save coverPicture: photo.get 'id'\n\n\n    # Display photo picker that allows to select pictures from the Files\n    # application.\n    displayBrowser: ->\n        new FilesBrowser\n            model: @album\n            collection: @collection\n            beforeUpload: @options.beforeUpload\n\n\n    # Display photo given in URL by triggering a photobox click event on the\n    # given photo.\n    showPhoto: (photoid) ->\n        url = \"photos/#{photoid}.jpg\"\n        $('a[href=\"' + url + '\"]').trigger('click.photobox')\n        setTimeout @onImageDisplayed, 10\n\n\n    # Close galery via photobox close button.\n    closePhotobox: ->\n        if @isViewing\n            $('#pbCloseBtn').click()\n","BaseView   = require 'lib/base_view'\nhelpers    = require '../lib/helpers'\nbaseLayers = require '../lib/map_providers'\n\nmodule.exports = class MapView extends BaseView\n\n    template: require 'templates/map'\n    className: 'masterClass'\n\n    initialize: (options) ->\n        super\n        @listenTo @collection, 'reset change',  @addAllMarkers\n        @markers = new L.MarkerClusterGroup\n            disableClusteringAtZoom:    17\n            removeOutsideVisibleBounds: false\n            animateAddingMarkers:       true\n\n    events: ->\n        'click #validate': 'validateChange'\n\n\n    afterRender: ->\n        #define leaflet images folder\n        L.Icon.Default.imagePath = 'leaflet-images'\n        #define lngitude and latitude to add on a new photo\n        @standbyLatlng = new L.latLng(null)\n        #define Marker used to add photos on the map\n        @standbyMarker = L.marker null,\n            draggable: true\n            icon: L.divIcon\n                className:  'leaflet-marker-div'\n                iconSize:   L.point 39, 45\n                html:       \"\"\"\n                    <i class=\"fa fa-crosshairs\" style=\"font-size:3.8em\"></i>\n                    \"\"\"\n\n        #map declaration\n        @map = L.map this.$('#map')[0],\n            center:     [46.8451, 2.4938]\n            zoom:       6       # 6 = default zoom\n            maxZoom:    17\n            minZoom:    2\n            layers:     baseLayers[\"Water color\"] #default map background\n            maxBounds:  L.latLngBounds [84.26, -170], [-59.888, 192.30]\n\n        @map.on 'contextmenu', (e) =>\n            # add marker where user rightclick\n            @standbyMarker.setLatLng e.latlng\n            @standbyMarker.addTo @map\n            @standbyLatlng = e.latlng\n            @standbyMarker.bindPopup @standbyLatlng.toString()\n            @dispChoiceBox()\n\n            @standbyMarker.on 'move', (e) =>\n                #update position when user move cursor\n                @standbyMarker.closePopup()\n                @standbyLatlng = e.latlng\n\n        @map.on 'click', ()=>\n            # hide marker and box with photos\n            @hide()\n\n        layerUrl = \"\"\"\n    http://otile{s}.mqcdn.com/tiles/1.0.0/{type}/{z}/{x}/{y}.{ext}\n    \"\"\"\n        attribution = \"\"\"\n    Tiles by <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>\n        \"\"\"\n        overlays = # map checkables layers\n            \"Photos\": @markers\n            \"Villes\" : L.tileLayer layerUrl,\n                type: 'hyb'\n                ext: 'png'\n                attribution: attribution\n                subdomains: '1234'\n                opacity: 0.9\n\n        # add control button on the map\n        layerControl = L.control.layers baseLayers, overlays,\n            position: 'bottomright'\n        .addTo @map\n\n        @map.addControl new L.Control.Search\n            url: 'https://nominatim.openstreetmap.org/search?format=json&q={s}'\n            jsonpParam: 'json_callback'\n            propertyName: 'display_name'\n            propertyLoc: ['lat','lon']\n            markerLocation: true\n\n    addAllMarkers: ->\n\n        @collection.hasGPS().each (photo) =>\n\n            gps      = photo.attributes.gps\n            position = new L.LatLng gps.lat, gps.long\n\n            imgPath = \"photos/thumbs/#{photo.get('id')}.jpg\"\n            text    = '<img src=\"images/spinner.svg\" width=\"150\" height=\"150\"/>'\n            button  = \"\"\"<button data-key=\"#{photo.get('id')}\"\n                class=\"btn btn-block\">\n                <span class=\"glyphicon gliphicon-move\"></span>\n                Relocaliser</button>\n                \"\"\"\n\n            tempMarker = L.marker position,\n                title: photo.get 'title'\n            .bindPopup text\n            tempMarker.cached = false\n            tempMarker.on 'popupopen', ->\n\n                if not tempMarker.cached\n                    img = $ '<img src=\"' + imgPath + '\" title=\"photo\"/>'\n                    element = $ \"<div><p>#{photo.get('title')}</p></div>\"\n                    description = photo.get 'description'\n                    element.append img\n                    element.append button\n                    unless photo.get('description')?\n                    then element.append $ \"<quote>#{description}</quote>\"\n                    img[0].onload = ->\n                        setTimeout ->\n                            tempMarker.getPopup().setContent element[0]\n                        , 500\n                        tempMarker.cached = true\n                    helpers.rotate photo.get('orientation'), img\n            @markers.addLayer tempMarker\n            @showAll()\n        @refresh()\n\n    showAll: ->\n        @map.addLayer @markers\n\n    dispChoiceBox: ->\n\n        $('.choice-box').height 'auto'\n        mapGalery = this.$('#map-galery')\n        mapGalery.children().remove()\n\n        @collection.hasNotGPS().each (photo) ->\n\n            imgPath  = \"photos/thumbs/#{photo.get('id')}.jpg\"\n            mapGalery.append '<img class=\"map-setter\" src=\"' +\\\n                imgPath + '\" data-key=\"' + photo.get('id') + '\"' +\\\n                '\" style=\"height: 130px; display: inline\"/>'\n\n    $(document).on \"click\", \".map-setter\", ()->\n        $(this).toggleClass 'map-photo-checked'\n\n    #Set new GPS coordinate to the photo\n    validateChange: (e)->\n        console.log e\n        that = this\n\n        $(\".map-photo-checked\").each ()->\n            el = $ this\n            photo = that.collection.get el.attr('data-key')\n            that.standbyLatlng.lng += 0.0001\n            photo?.save gps:\n                lat:    that.standbyLatlng.lat\n                long:   that.standbyLatlng.lng\n                alt:    0\n\n            , success: (e) ->\n                e.preventDefault()\n\n            , error: (e) ->\n                e.preventDefault()\n        that.hide()\n\n    # Hide cursor and bottom box\n    hide: ->\n        $('.choice-box').height 0\n        @map.removeLayer @standbyMarker\n\n    refresh: ->\n        @map.invalidateSize() # force to load all map tiles\n\n\n","BaseView = require 'lib/base_view'\nhelpers = require 'lib/helpers'\n\ntransitionendEvents = [\n    \"transitionend\", \"webkitTransitionEnd\", \"oTransitionEnd\", \"MSTransitionEnd\"\n].join(\" \")\n\n# View for a single photo\n# Expected options {model, editable}\nmodule.exports = class PhotoView extends BaseView\n    template: require 'templates/photo'\n    className: 'photo'\n\n    initialize: (options) ->\n        super\n        @listenTo @model, 'progress',        @onProgress\n        @listenTo @model, 'thumbed',         @onThumbed\n        @listenTo @model, 'upError',         @onError\n        @listenTo @model, 'uploadComplete',  @onServer\n        @listenTo @model, 'change',          => @render()\n\n    events: ->\n        'click' : 'onClickListener'\n        'click .delete' : 'destroyModel'\n\n    getRenderData: -> @model.attributes\n\n    afterRender: ->\n        @link =        @$ 'a'\n        @image =       @$ 'img'\n        @progressbar = @$ '.progressfill'\n        helpers.rotate @model.get('orientation'), @image\n        @link.addClass 'server' unless @model.isNew()\n\n        # Images are not loaded by default, they are only loaded when the\n        # user reaches them by scrolling the window.\n        @image.unveil()\n\n        if @image.get(0).complete\n            @onImageLoaded()\n        else\n            @image.on 'load', =>\n                @onImageLoaded()\n\n    # Force display of current image by setting its source attribute.\n    setSource: ->\n        source = @$(\"img\").attr \"data-src\"\n        @$(\"img\").attr \"src\", source\n\n    # Change progress bar state to show the progress of the upload.\n    setProgress: (percent) ->\n        @progressbar.css 'width', percent + '%'\n\n    # when the upload progresses\n    onProgress: (event) ->\n        @setProgress 10 + 90 * event.loaded / event.total\n\n    # when the thumb is ready, it is displayed.\n    onThumbed: ->\n        @setProgress 10\n        @image.attr 'src', @model.thumb_du\n        @image.attr 'orientation', @model.get('orientation')\n        @image.addClass 'thumbed'\n\n    # when the upload is complete, the view of the photo is refreshed via a\n    # remove/add.\n    onServer: ->\n        # detach-reatach so photobox can pick up the object\n        preload = new Image()\n        preload.onerror = preload.onload = =>\n            @render()\n\n        preload.src = \"photos/thumbs/#{@model.id}.jpg\"\n        # image loaded, we can navigate away\n        app.router.mainView.dirty = false\n\n    # when an error occured, the photo is marked with error image.\n    onError: (err) ->\n        @setProgress 0\n        @error = @model.get('title') + \" \" + err\n        @link.attr 'title', @error\n        @image.attr 'src', 'img/error.gif'\n\n    # Prevent opening the gallery if the photos\n    # hasn't been upload yet\n    onClickListener: (evt) =>\n\n        if @model.isNew()\n            alert @error if @error\n            evt.stopPropagation()\n            evt.preventDefault()\n            return false\n\n    destroyModel: ->\n        @$('.delete').html '&nbsp;&nbsp;&nbsp;&nbsp;'\n        @$('.delete').spin 'small'\n        @$el.fadeOut =>\n            @model.destroy\n                success: =>\n                    @collection.remove @model\n                    @remove()\n\n    onImageLoaded: ->\n        @image.addClass 'loaded'\n"]}